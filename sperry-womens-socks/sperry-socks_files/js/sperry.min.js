(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var snippetFactory=function(win,doc,history,nav,opts){var dependencies={windowProvider:win,documentProvider:doc,historyProvider:history,navigatorProvider:nav,optionsProvider:opts?opts:null};var frameConfig={frameId:"sm-frame",frameUrl:null,frameLoaded:false,frameObj:null,frameDomain:"*",clientTranslator:null};var messageQueue=[];var messageInfo={apiKey:null,referrer:null,origUrl:null,hashId:null,shareId:null,marketingProperties:null};var urlParams={utm_source:1,utm_term:1,utm_medium:1,utm_campaign:1,utm_content:1,gclid:1,gclsrc:1,tid:1,url:1,aid:1,idfa:1,cs:1,cm:1,cn:1,cc:1,ck:1,anid:1,hash:1,dl:1,dr:1,src:1,cid:1,sc_mc:1,eVar:1,evar:1,sProp:1,sprop:1,"s.tl()":1,"s.tracklink()":1,"s.linkTrackVars":1,"s.linkTrackEvents":1,"s.prop1":1,"s.events":1,cm_ven:1,cm_cat:1,cm_ite:1,cm_pla:1,cm_mmc:1,cm_sp:1,cm_re:1};var urlConfig={queryParam:dependencies.optionsProvider&&dependencies.optionsProvider.queryParam||"sma",key:"sm.",urlHash:null,urlSearch:null};function browserSpecificConfiguration(){function stringifyMessageTranslator(objMessage){return JSON.stringify(objMessage)}if("withCredentials"in new dependencies.windowProvider.XMLHttpRequest){frameConfig.frameUrl="//sm-cdn.simplymeasured.com/httpclient/html5Client.html"}else if(dependencies.windowProvider.XDomainRequest&&dependencies.windowProvider.addEventListener){frameConfig.frameUrl="//sm-cdn.simplymeasured.com/httpclient/ie9Client.html";frameConfig.clientTranslator=stringifyMessageTranslator}else if(dependencies.windowProvider.XDomainRequest&&dependencies.windowProvider.attachEvent){frameConfig.frameUrl="//sm-cdn.simplymeasured.com/httpclient/ie8Client.html";frameConfig.clientTranslator=stringifyMessageTranslator}}function appendIframe(){if(frameConfig.frameUrl){frameConfig.frameObj=dependencies.documentProvider.getElementById(frameConfig.frameId);if(!frameConfig.frameObj){frameConfig.frameObj=dependencies.documentProvider.createElement("iframe");frameConfig.frameObj.id=frameConfig.frameId;frameConfig.frameObj.height="0";frameConfig.frameObj.width="0";frameConfig.frameObj.src=frameConfig.frameUrl;frameConfig.frameObj.style.display="none";dependencies.documentProvider.body.insertBefore(frameConfig.frameObj,dependencies.documentProvider.body.firstChild)}}}function urlFixup(){var invalidHashLocation=urlConfig.urlHash?urlConfig.urlHash.indexOf("?"):-1;if(invalidHashLocation===-1){invalidHashLocation=urlConfig.urlHash?urlConfig.urlHash.indexOf("&"):-1}if(invalidHashLocation!==-1){var invalidQuery=urlConfig.urlHash.substring(invalidHashLocation);urlConfig.urlHash=urlConfig.urlHash.substring(0,invalidHashLocation-1);if(!urlConfig.urlSearch){urlConfig.urlSearch=invalidQuery}else{invalidQuery[0]="&";urlConfig.urlSearch+=invalidQuery}}}function setUrl(){if(dependencies.windowProvider===dependencies.windowProvider.top){urlFixup();var stateObj={mod:"sm"};var uniquifiedUrl=generateUserSpecificUrl();if(dependencies.historyProvider&&dependencies.historyProvider.replaceState){history.replaceState(stateObj,"url",uniquifiedUrl)}else if(!dependencies.optionsProvider||dependencies.optionsProvider&&dependencies.optionsProvider.querytizeHash!==true){dependencies.windowProvider.location.hash=urlConfig.key+messageInfo.hashId}}}function gatherQueryKeys(){var search=urlConfig.urlSearch;var keys=[];if(search.length>0){keys=search.substr(1).split("&")}for(var i=0;i<keys.length;i++){keys[i]=keys[i].split("=")}return keys}function urlifyKeysQuery(queryKeys){var keysToReturn=[];for(var i=0;i<queryKeys.length;i++){keysToReturn[i]=queryKeys[i].join("=")}return keysToReturn}function generateUserSpecificUrl(){var urlParameterToInject=urlConfig.key+messageInfo.hashId;var path=dependencies.windowProvider.location.pathname;if(dependencies.optionsProvider&&dependencies.optionsProvider.querytizeHash===true){var keys=gatherQueryKeys();var changed=false;for(var ikey=0;ikey<keys.length;ikey++){var key=keys[ikey];if(key[0]===urlConfig.queryParam){key[1]=urlParameterToInject;keys[ikey]=key;changed=true;break}}if(changed===false&&!isExcludedUrl()){keys.push([urlConfig.queryParam,urlParameterToInject])}if(urlifyKeysQuery(keys).length==0){return path}return path+"?"+urlifyKeysQuery(keys).join("&")+urlConfig.urlHash}else{if(urlConfig.urlSearch){path+=urlConfig.urlSearch}if(isExcludedUrl()){return path}return path+"#"+urlParameterToInject}}function isExcludedUrl(){if(dependencies.optionsProvider&&dependencies.optionsProvider.excludedUrls){var urlsToExclude=dependencies.optionsProvider.excludedUrls;for(var i=0;i<urlsToExclude.length;i++){if(dependencies.windowProvider.location.href.indexOf(urlsToExclude[i])!==-1){return true}}}return false}function gatheringMarketingProperties(search){var query=search.substr(1).split("&");var result={};for(var i=0;i<query.length;i++){var item=query[i].split("=");if(urlParams[item[0]]&&urlParams[item[0]]===1){result[item[0]]=decodeURIComponent(item[1])}}return result}function gatherData(){urlConfig.urlHash=dependencies.windowProvider.location.hash;urlConfig.urlSearch=dependencies.windowProvider.location.search;messageInfo.origUrl=dependencies.documentProvider.location.href;messageInfo.referrer=dependencies.documentProvider.referrer;messageInfo.marketingProperties=gatheringMarketingProperties(urlConfig.urlSearch);gatherShareId()}function sanatizeShareId(shareId){for(var i=0;i<shareId.length;i++){if(!validHashChar(shareId.charAt(i))){break}}return shareId.substr(0,i)}function gatherShareId(){if(dependencies.optionsProvider&&dependencies.optionsProvider.querytizeHash===true){var keys=gatherQueryKeys();for(var i=0;i<keys.length;i++){var key=keys[i];if(key[0]===urlConfig.queryParam&&key[1].indexOf(urlConfig.key)===0){var urlQueryKeyParts=key[1].split(urlConfig.key);messageInfo.shareId=sanatizeShareId(urlQueryKeyParts[1])}}}else if(urlConfig.urlHash.indexOf(urlConfig.key)===1){var urlHashParts=urlConfig.urlHash.split(urlConfig.key);messageInfo.shareId=sanatizeShareId(urlHashParts[1])}}function validHashChar(c){return c<="9"&&c>="0"||c>="a"&&c<="z"}function bodyReady(){if(dependencies.documentProvider.body){gatherData();appendIframe()}else{setTimeout(bodyReady,100)}}function jsonMerge(a,b){for(var key in b){if(b.hasOwnProperty(key)){a[key]=b[key]}}return a}function prepMessage(message){if(frameConfig.clientTranslator){return frameConfig.clientTranslator(message)}else{return message}}function sendQueuedMessages(){for(var iMessageQueue=0;iMessageQueue<messageQueue.length;iMessageQueue++){var message=messageQueue[iMessageQueue];message=prepMessage(message);frameConfig.frameObj.contentWindow.postMessage(message,frameConfig.frameDomain)}}function processMessage(e){var message=null;try{message=JSON.parse(e.data)}catch(ex){}if(message&&message.name=="smFrameLoaded"){frameConfig.frameLoaded=true;dependencies.windowProvider.smt.hashId=messageInfo.hashId=message.data.hashId;setUrl();dependencies.windowProvider.smt.sendMessage(101);sendQueuedMessages()}}function onbeforeunload(){dependencies.windowProvider.smt.sendMessage(102)}return{initClient:function(apiKey){messageInfo.apiKey=apiKey;browserSpecificConfiguration();if(dependencies.windowProvider.addEventListener){dependencies.windowProvider.addEventListener("message",processMessage);dependencies.windowProvider.addEventListener("beforeunload",onbeforeunload)}else{dependencies.windowProvider.attachEvent("onmessage",processMessage);dependencies.windowProvider.attachEvent("onbeforeunload",onbeforeunload)}dependencies.windowProvider.smt={sendMessage:function(event,params){if(messageInfo.apiKey){var marketingPropertiesKeys;var objMessage={event:event,originalUrl:messageInfo.origUrl,userAgent:dependencies.navigatorProvider.userAgent};if(messageInfo.referrer){objMessage.referrer=messageInfo.referrer}if(messageInfo.shareId&&messageInfo.shareId!==messageInfo.hashId){objMessage.shareId=messageInfo.shareId}var keys=[];for(var i in messageInfo.marketingProperties){if(messageInfo.marketingProperties.hasOwnProperty(i)){keys.push(i)}}marketingPropertiesKeys=keys;if(marketingPropertiesKeys.length>0&&JSON&&JSON.stringify){objMessage.marketingProperties=JSON.stringify(messageInfo.marketingProperties)}else{objMessage.marketingProperties=""}if(params){objMessage=jsonMerge(objMessage,params)}objMessage.apiKey=messageInfo.apiKey;objMessage=prepMessage(objMessage);if(frameConfig.frameLoaded){frameConfig.frameObj.contentWindow.postMessage(objMessage,frameConfig.frameDomain)}else{messageQueue.push(objMessage)}}}};bodyReady()}}};if(typeof module.exports!=="undefined"){module.exports=snippetFactory}},{}],2:[function(require,module,exports){var snippetFactory=require("../../core.js")(window,document,history,navigator,{querytizeHash:true,excludedUrls:["http://www.sperry.com/en/womens/","http://www.sperry.com/en/mens/","http://www.sperry.com/en/home","staging-na-wwwinc.demandware"]});snippetFactory.initClient("cf075757ab954c069e87a165428177d7");var timeOutHelper=function(){if(document.body&&typeof window.jQuery==="function"){loadEvents()}else{setTimeout(timeOutHelper,200)}};setTimeout(timeOutHelper,200);function loadEvents(){}},{"../../core.js":1}]},{},[1,2]);